<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prompt Organizer</title>

    <style>
        :root {
            --gradient-grey: linear-gradient(135deg, #4a4a4a, #2e2e2e);
            --light-grey: #f8f9fa;
            --dark-grey: #343a40;
            --subtle-grey: #5a5a5a;
            --standard-grey: #c0c0c0;
          
            --white: #ffffff;
            --light-button-grey: #d3d3d3;
            --font-family: 'Roboto', sans-serif;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --title-font-size: 2rem;
            --subsubtitle-font-size: 1.5rem;
            --subtitle-color: var(--dark-grey);

            --blue-color: #0000ff;
            --blue-color-dark: #0000cc;
          
            --red-color: #ff0000;
            --red-color-dark: #a50000;
        }

        body {
            margin: 0;
            font-family: var(--font-family);
            background-color: var(--light-grey);
            color: var(--dark-grey);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        header {
            background: var(--gradient-grey);
            color: var(--white);
            padding: var(--space-lg);
            text-align: center;
            font-size: var(--title-font-size);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            width: 100%;
            margin-bottom: var(--space-md);
        }

        .container {
            display: block;
            flex-direction: column;
            padding: 0 var(--space-md);
            margin: auto;
            max-width: 800px;
            width: 100%;
        }

        .title-container {
            margin-bottom: var(--space-md);
			display: block;
			width: 100%;
        }

        .subtitle {
            font-size: var(--title-font-size);
            color: var(--subtitle-color);
            margin-bottom: var(--space-md);
			display: block;
			width: 100%;

			
        }

        .button-container {
            
			display: flex;
            justify-content: left;
            align-items: left;
            gap: var(--space-sm);
            flex-wrap: wrap;
            margin-bottom: var(--space-lg);
        }
		

        .load-button, .save-button, .add-category-button, .add-prompt-button, .back-button, .delete-button {
            background-color: var(--light-button-grey);
            border-radius: 8px;
            padding: var(--space-md) var(--space-md);
            border: none;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s ease;
            color: var(--dark-grey);
        }

        .load-button:hover, .save-button:hover, .add-category-button:hover, .add-prompt-button:hover, .back-button:hover, .delete-button:hover {
            background-color: var(--subtle-grey);
            color: var(--white);
        }

        .input-container, .prompt-input-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-start;
            margin-top: var(--space-md);
        }

        .category-input, .prompt-input {
            padding: var(--space-sm);
            font-size: 1rem;
            border-radius: 8px;
            border: 1px solid var(--dark-grey);
            margin-bottom: var(--space-sm);
            width: 100%;
        }

        .category, .prompt-container {
            display: flex;
            align-items: center;
            background-color: var(--white);
            border-radius: 12px;
            margin: var(--space-sm) 0;
            padding: var(--space-md);
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .category:hover, .prompt-container:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .hidden {
            display: none;
        }

        .disabled {
            pointer-events: none;
            opacity: 0.5;
        }

        .prompt-buttons {
            margin-left: auto;
            display: flex;
            gap: var(--space-sm);
        }

        .edit-button, .delete-button-small {
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            color: var(--white);
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .edit-button {
            background-color: var(--dark-grey);  
        }

        .delete-button-small {
            background-color: var(--red-color-dark);  
        }

        .edit-button:hover {
            background-color: var(--standard-grey);
        }

        .delete-button-small:hover {
            background-color: var(--red-color);
        }

        @media (min-width: 768px) {
            .container {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: space-around;
            }

            .category, .prompt-container {
                flex: 0 1 calc(45% - var(--space-md));
            }
        }

        .popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--dark-grey);
            color: var(--white);
            padding: var(--space-md) var (--space-lg);
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            z-index: 1000;
        }

        .popup.show {
            opacity: 1;
        }

        input[type="file"] {
            display: none;
        }
    </style>
</head>
<body>
    <header>Prompt Organizer</header>
    <div class="container">
        <div class="title-container">
            <div class="subtitle" id="pageTitle">Categories</div>
        </div>

    </div>
	<div class="button-container">
		<label class="load-button" for="fileInput" id="loadFileButton">Load Prompts File</label>
		<input type="file" id="fileInput" accept=".json" onchange="loadFile(event)">
		<button class="save-button hidden" id="saveFileButton" onclick="saveFile()">Save Prompts File</button>
		<button class="add-category-button hidden" id="addCategoryButton" onclick="navigateToAddCategory()">+ Add new category</button>
	</div>
    <div class="container" id="categories">
        <!-- Categories will be rendered here -->
    </div>
    <div class="container hidden" id="prompts">
        <div class="button-container">
            <button class="back-button" onclick="goBack()">Back</button>
            <button class="add-prompt-button" onclick="navigateToAddPrompt()">+ Add new prompt</button>
            <button class="delete-button disabled" id="deleteCategoryButton" onclick="deleteCategory()">Delete Category</button>
        </div>
        <div id="promptsList">
            <!-- Prompts will be rendered here -->
        </div>
    </div>
    <div class="container hidden" id="addCategory">
        <div class="subsubtitle">New Category</div>
        <div class="button-container">
            <button class="back-button" onclick="goBack()">Back</button>
        </div>
        <div class="input-container">
            <input type="text" id="newCategoryInput" class="category-input" placeholder="Enter category name" />
            <button class="save-button" onclick="saveCategory()">Save</button>
        </div>
    </div>
    <div class="container hidden" id="addPrompt">
        <div class="subtitle">New Prompt in <span id="currentCategoryName"></span></div>
        <div class="button-container">
            <button class="back-button" onclick="goBack()">Back</button>
        </div>
        <div class="prompt-input-container">
            <input type="text" id="newPromptName" class="prompt-input" placeholder="Enter prompt name" />
            <input type="text" id="newPromptInfo" class="prompt-input" placeholder="Enter prompt information" />
            <textarea id="newPromptText" class="prompt-input" placeholder="Enter prompt text" rows="4"></textarea>
            <button class="save-button" onclick="savePrompt()">Save</button>
        </div>
    </div>
    <div class="popup" id="popupMessage">Prompt copied to clipboard!</div>
    <script>
        let data;
        let currentCategory;
        let currentPrompt;

        function loadFile(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        data = JSON.parse(e.target.result);
                        renderCategories();
                        showElement('addCategoryButton');
                        showElement('saveFileButton');
                        showPopup('Prompts loaded successfully!');
                    } catch (error) {
                        console.error('Error parsing JSON:', error);
                        showPopup('Error parsing JSON file');
                    }
                };
                reader.readAsText(file);
            }
        }

        function saveFile() {
            const filename = prompt('Enter filename for the prompts (e.g., prompts.json):', 'prompts.json');
            if (!filename) {
                showPopup('Save operation cancelled');
                return;
            }
            const jsonString = JSON.stringify(data, null, 2);
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
            showPopup('Prompts file saved successfully!');
        }

        function showElement(elementId) {
            document.getElementById(elementId).classList.remove('hidden');
        }

        function hideElement(elementId) {
            document.getElementById(elementId).classList.add('hidden');
        }

        function enableElement(elementId) {
            document.getElementById(elementId).classList.remove('disabled');
        }

        function disableElement(elementId) {
            document.getElementById(elementId).classList.add('disabled');
        }

        function updateTitle(newTitle) {
            document.getElementById('pageTitle').innerText = newTitle;
        }

        function renderCategories() {
            const categoriesContainer = document.getElementById('categories');
            categoriesContainer.innerHTML = ''; // Clear previous content
            data.categories.forEach(category => {
                const categoryButton = document.createElement('div');
                categoryButton.className = 'category';
                categoryButton.innerText = category.name;
                categoryButton.onclick = () => showPrompts(category);
                categoriesContainer.appendChild(categoryButton);
            });
        }

        function showPrompts(category) {
            currentCategory = category;
            showElement('pageTitle');
            hideElement('categories');
            hideElement('addCategoryButton');
            hideElement('saveFileButton');
            hideElement('loadFileButton');
            showElement('prompts');
            updateTitle(category.name);

            // Check if category is empty to enable/disable delete button
            if (category.prompts.length === 0) {
                enableElement('deleteCategoryButton');
            } else {
                disableElement('deleteCategoryButton');
            }

            const promptsContainer = document.getElementById('promptsList');
            promptsContainer.innerHTML = ''; // Clear previous prompts

            category.prompts.forEach((promptData, index) => {
                const promptContainer = document.createElement('div');
                promptContainer.className = 'prompt-container';

                const promptButton = document.createElement('div');
                promptButton.className = 'prompt';
                promptButton.innerText = promptData.title;
                promptButton.title = promptData.shortExplanation;
                promptButton.onclick = () => copyToClipboard(promptData.prompt);

                const buttonsContainer = document.createElement('div');
                buttonsContainer.className = 'prompt-buttons';

                const editButton = document.createElement('button');
                editButton.className = 'edit-button';
                editButton.innerHTML = '§';
                editButton.onclick = (e) => {
                    e.stopPropagation();
                    navigateToEditPrompt(promptData, index);
                };

                const deleteButton = document.createElement('button');
                deleteButton.className = 'delete-button-small';
                deleteButton.innerHTML = 'x';
                deleteButton.onclick = (e) => {
                    e.stopPropagation();
                    confirmDeletePrompt(index);
                };

                buttonsContainer.appendChild(editButton);
                buttonsContainer.appendChild(deleteButton);
                promptContainer.appendChild(promptButton);
                promptContainer.appendChild(buttonsContainer);

                promptsContainer.appendChild(promptContainer);
            });
        }

        function confirmDeletePrompt(index) {
            const confirmation = confirm("Are you sure you want to delete this prompt?");
            if (confirmation) {
                currentCategory.prompts.splice(index, 1);
                showPrompts(currentCategory); // Re-render the prompts list
                showPopup('Prompt deleted successfully!');
            }
        }

        function deleteCategory() {
            // Find the index of the current category and remove it
            const index = data.categories.indexOf(currentCategory);
            if (index !== -1) {
                data.categories.splice(index, 1);
            }

            // Go back to categories view and re-render categories
            goBack();
            renderCategories();
            showPopup('Category deleted successfully!');
        }

        function navigateToAddPrompt() {
            document.getElementById('currentCategoryName').innerText = currentCategory.name;
            hideElement('prompts');
            showElement('addPrompt');
            hideElement('pageTitle');
            currentPrompt = null; // Reset currentPrompt when adding a new prompt
        }

        function navigateToEditPrompt(promptData, index) {
            currentPrompt = index; // Store the index of the prompt being edited
            document.getElementById('newPromptName').value = promptData.title;
            document.getElementById('newPromptInfo').value = promptData.shortExplanation;
            document.getElementById('newPromptText').value = promptData.prompt;
            navigateToAddPrompt(); // Reuse the Add Prompt page for editing
        }

        function savePrompt() {
            const newPromptName = document.getElementById('newPromptName').value.trim();
            const newPromptInfo = document.getElementById('newPromptInfo').value.trim();
            const newPromptText = document.getElementById('newPromptText').value.trim();

            if (newPromptName === '' || newPromptText === '') {
                showPopup('Prompt name and text cannot be empty');
                return;
            }

            const promptData = {
                title: newPromptName,
                shortExplanation: newPromptInfo,
                prompt: newPromptText
            };

            if (currentPrompt === null) {
                currentCategory.prompts.push(promptData); // Add new prompt
            } else {
                currentCategory.prompts[currentPrompt] = promptData; // Update existing prompt
            }

            // Clear input fields
            document.getElementById('newPromptName').value = '';
            document.getElementById('newPromptInfo').value = '';
            document.getElementById('newPromptText').value = '';

            // Hide the add/edit prompt form and show the prompts list
            hideElement('addPrompt');
            showPrompts(currentCategory);

            showPopup(currentPrompt === null ? 'Prompt added successfully!' : 'Prompt updated successfully!');
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showPopup('Prompt copied to clipboard!');
            }).catch(err => {
                console.error('Could not copy text: ', err);
            });
        }

        function showPopup(message) {
            const popup = document.getElementById('popupMessage');
            popup.innerText = message;
            popup.classList.add('show');
            setTimeout(() => {
                popup.classList.remove('show');
            }, 1000);
        }

        function goBack() {
            showElement('pageTitle');
            showElement('categories');
            hideElement('prompts');
            hideElement('addCategory');
            hideElement('addPrompt');
            updateTitle('Categories');
            showElement('addCategoryButton');
            showElement('saveFileButton');
            showElement('loadFileButton');
        }

        function navigateToAddCategory() {
            hideElement('pageTitle');
            hideElement('categories');
            hideElement('addCategoryButton');
            hideElement('saveFileButton');
            hideElement('loadFileButton');
            showElement('addCategory');
        }

        function saveCategory() {
            const newCategoryName = document.getElementById('newCategoryInput').value.trim();
            if (newCategoryName === '') {
                showPopup('Category name cannot be empty');
                return;
            }

            data.categories.push({
                name: newCategoryName,
                prompts: []
            });

            renderCategories();
            goBack();
            showPopup('Category added successfully!');
        }
    </script>
</body>
</html>
